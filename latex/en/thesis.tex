%%% The main file. It contains definitions of basic parameters and includes all other parts.

%% Settings for single-side (simplex) printing
% Margins: left 40mm, right 25mm, top and bottom 25mm
% (but beware, LaTeX adds 1in implicitly)
\documentclass[12pt,a4paper]{report}
\setlength\textwidth{145mm}
\setlength\textheight{247mm}
\setlength\oddsidemargin{15mm}
\setlength\evensidemargin{15mm}
\setlength\topmargin{0mm}
\setlength\headsep{0mm}
\setlength\headheight{0mm}
% \openright makes the following text appear on a right-hand page
\let\openright=\clearpage

%% Settings for two-sided (duplex) printing
% \documentclass[12pt,a4paper,twoside,openright]{report}
% \setlength\textwidth{145mm}
% \setlength\textheight{247mm}
% \setlength\oddsidemargin{14.2mm}
% \setlength\evensidemargin{0mm}
% \setlength\topmargin{0mm}
% \setlength\headsep{0mm}
% \setlength\headheight{0mm}
% \let\openright=\cleardoublepage

%% Generate PDF/A-2u
\usepackage[a-2u]{pdfx}

%% Character encoding: usually latin2, cp1250 or utf8:
\usepackage[utf8]{inputenc}

%% Prefer Latin Modern fonts
\usepackage{lmodern}

%% Further useful packages (included in most LaTeX distributions)
\usepackage{amsmath}        % extensions for typesetting of math
\usepackage{amsfonts}       % math fonts
\usepackage{amsthm}         % theorems, definitions, etc.
\usepackage{bbding}         % various symbols (squares, asterisks, scissors, ...)
\usepackage{bm}             % boldface symbols (\bm)
\usepackage{graphicx}       % embedding of pictures
\usepackage{fancyvrb}       % improved verbatim environment
\usepackage[numbers]{natbib}         % citation style AUTHOR (YEAR), or AUTHOR [NUMBER]
\usepackage[nottoc]{tocbibind} % makes sure that bibliography and the lists
			    % of figures/tables are included in the table
			    % of contents
\usepackage{dcolumn}        % improved alignment of table columns
\usepackage{booktabs}       % improved horizontal lines in tables
\usepackage{paralist}       % improved enumerate and itemize
\usepackage{xcolor}         % typesetting in color
\usepackage[textsize=tiny]{todonotes}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{subcaption}
\usepackage[page,toc,titletoc,title]{appendix}


\reversemarginpar
%%% Basic information on the thesis

% Thesis title in English (exactly as in the formal assignment)
\def\ThesisTitle{Optimal Choice of Scenario Tree using Reinforcement Learning}

% Author of the thesis
\def\ThesisAuthor{Bc. Jakub Vondráček}

% Year when the thesis is submitted
\def\YearSubmitted{2023}

% Name of the department or institute, where the work was officially assigned
% (according to the Organizational Structure of MFF UK in English,
% or a full name of a department outside MFF)
\def\Department{Department of Probability and Mathematical Statistics}

% Is it a department (katedra), or an institute (ústav)?
\def\DeptType{Department}

% Thesis supervisor: name, surname and titles
\def\Supervisor{doc.~RNDr.~Ing.~Miloš~Kopa,~Ph.D.}

% Supervisor's department (again according to Organizational structure of MFF)
\def\SupervisorsDepartment{Department of Probability and Mathematical Statistics}

% Study programme and specialization
\def\StudyProgramme{Probability, mathematical statistics and econometrics}
\def\StudyBranch{MPSP}

% An optional dedication: you can thank whomever you wish (your supervisor,
% consultant, a person who lent the software, etc.)
\def\Dedication{%
I am infinitely grateful to my supervisor doc.~RNDr.~Ing.~Miloš~Kopa,~Ph.D. for his expertise, patience and all the time and effort spent supervising my thesis and for providing the necessary GAMS license. 

I am also deeply indebted to my consultant RNDr.~Karel~Kozmík for infinitely many great ideas, suggestions and always being ready to help whenever I needed guidance.

I dedicate this thesis to my grandmother and my mother, as without them, I would be nowhere near as far along in life as I am today. Thank you.
}

% Abstract (recommended length around 80-200 words; this is not a copy of your thesis assignment!)
\def\Abstract{%
This thesis deals with multistage stochastic programs and explores the dependence of the obtained objective value on the chosen structure of the scenario tree. In particular, the scenario trees are built using the moment matching method, a multistage mean-CVaR model is formulated and a reinforcement learning agent is trained on a set of historical financial data to choose the best scenario tree structure. For this purpose, we implemented a custom reinforcement learning environment. Further an inclusion of a penalty term in the reward obtained by the agent is proposed to avoid scenario trees that are too complex. The reinforcement learning agent is then evaluated against an agent that chooses the scenario tree structure at random and outperforms the random agent. Further the structure of scenario trees chosen by the reinforcement learning agent is analyzed.
}

% 3 to 5 keywords (recommended), each enclosed in curly braces
	\def\Keywords{%
{Stochastic optimization}, {Multistage problem}, {Reinforcement learning}
}

%% The hyperref package for clickable links in PDF and also for storing
%% metadata to PDF (including the table of contents).
%% Most settings are pre-set by the pdfx package.
\hypersetup{unicode}
\hypersetup{breaklinks=true}

% Definitions of macros (see description inside)
\include{macros}

\usepackage{sectsty}
\allsectionsfont{\raggedright}

\renewcommand*{\cite}{\citet}

% Title page and various mandatory informational pages
\begin{document}
\include{title}

%%% A page with automatically generated table of contents of the master thesis

\tableofcontents

%%% Each chapter is kept in a separate file
\include{preface}
\include{chap01}
\include{chap02}
\include{chap03}
\include{chap04}


\include{epilog}

%%% Bibliography
\include{bibliography}

%%% Figures used in the thesis (consider if this is needed)
%\listoffigures

%%% Tables used in the thesis (consider if this is needed)
%%% In mathematical theses, it could be better to move the list of tables to the beginning of the thesis.
%\listoftables

%%% Abbreviations used in the thesis, if any, including their explanation
%%% In mathematical theses, it could be better to move the list of abbreviations to the beginning of the thesis.
%\chapwithtoc{List of Abbreviations}

%%% Attachments to the master thesis, if any. Each attachment must be
%%% referred to at least once from the text of the thesis. Attachments
%%% are numbered.
%%%
%%% The printed version should preferably contain attachments, which can be
%%% read (additional tables and charts, supplementary text, examples of
%%% program output, etc.). The electronic version is more suited for attachments
%%% which will likely be used in an electronic form rather than read (program
%%% source code, data files, interactive charts, etc.). Electronic attachments
%%% should be uploaded to SIS and optionally also included in the thesis on a~CD/DVD.
%%% Allowed file formats are specified in provision of the rector no. 72/2017.

\appendix
\chapter*{Appendix}
\stepcounter{chapter}
\addcontentsline{toc}{chapter}{Appendix}
\section{Definitions of asset sets}
\begin{center}
\begin{table}[H]
\centering
\begin{tabular}{lllllll}
\toprule
 ACGL &   AFL &  AIG &   AJG &   ALL &   AON &   AXP \\
  BAC &   BEN &   BK &   BLK &   BRO &     C &    CB \\
 CINF &   CMA &  COF &   FDS &  FITB &    GL &    GS \\
 HBAN &   HIG &  IVZ &   JPM &   KEY &     L &   LNC \\
   MCO &   MMC &   MS &   MTB &  NTRS &   PGR &   PNC \\
   RE &    RF &  RJF &  SCHW &  SIVB &  SPGI &   STT \\
   TFC &  TROW &  TRV &   USB &   WFC &   WRB &  ZION \\
   \bottomrule
\end{tabular}
\caption{Stock tickers used in Chapter \ref{chapter4}.}
\label{table:stock_tickers_used}
\end{table}

\begin{table}[H]
\centering
\begin{tabular}{llllll}
\toprule
ALL &   BK &  ACGL &  FDS &  ZION &  TROW \\
 STT &  RJF &  SPGI &  AON &   LNC &   USB \\
 AXP &  AIG &   AJG &  BLK &    RE &  SIVB \\
 NTRS &   CB &   WRB &  BRO &     L &   IVZ \\
  BAC &   GS &   WFC &  MTB &   MMC &   BEN \\
  \bottomrule
\end{tabular}
\caption{Stock tickers in set $A$.}
\label{table:stock_tickers_in_set_A}
\end{table}


\begin{table}[H]
\centering
\begin{tabular}{llll}
\toprule
 HBAN &   COF &  JPM &  AFL \\
 PGR &   CMA &   RF &  TFC \\
 CINF &   MCO &   MS &    C \\
  HIG &  FITB &  TRV &   GL \\
 SCHW &   PNC &  KEY &     \\
 \bottomrule
\end{tabular}
\caption{Stock tickers in set $B$.}
\label{table:stock_tickers_in_set_B}
\end{table}

\begin{table}[H]
\centering
\scalebox{0.75}{
\begin{tabular}{l|llllllllll}
\toprule
Asset set 1 & ALL & BK  & ACGL & FDS & ZION & TROW & STT & RJF  & SPGI & AON \\
\toprule
Asset set 2 & LNC & USB & AXP  & AIG & AJG  & BLK  & RE  & SIVB & NTRS & CB  \\
\toprule
Asset set 3 & WRB & BRO & L    & IVZ & BAC  & GS   & WFC & MTB  & MMC  & BEN \\
\bottomrule
\end{tabular}
}
\caption{Specification of which stock tickers belong to which asset set.}
\label{table:asset_sets}
\end{table}
\end{center}

\section{Electronic attachment}
The Python source code used to obtain the results in Chapter \ref{chapter4} is included in the electronic attachment.
\openright
\end{document}
